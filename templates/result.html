<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnosis Result ‚Äî PawScan AI</title>
    <meta name="description"
        content="AI-powered dog skin disease diagnosis results. View detected condition, confidence level, and treatment recommendations.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="bg-gradient"></div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo">
                <span class="logo-icon">üêæ</span>
                <span class="logo-text">PawScan <span class="logo-ai">AI</span></span>
            </a>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/#how-it-works" class="nav-link">How It Works</a>
            </div>
        </div>
    </nav>

    <!-- Result Section -->
    <section class="result-section">
        <div class="result-container">
            <div class="result-header">
                <h1>Diagnosis Result</h1>
                <p>Here's what our AI model detected</p>
            </div>

            <div class="result-grid">
                <!-- Uploaded Image -->
                <div class="result-image-card glass-card">
                    <h3>Uploaded Image</h3>
                    <div class="result-image-wrapper">
                        <img src="{{ image_url }}" alt="Uploaded dog skin image" class="result-image">
                    </div>
                </div>

                <!-- Prediction Result -->
                <div class="result-prediction-card glass-card">
                    <div
                        class="prediction-badge {% if disease.slug == 'healthy_skin' %}badge-healthy{% else %}badge-disease{% endif %}">
                        {% if disease.slug == 'healthy_skin' %}
                        ‚úÖ Healthy
                        {% else %}
                        ‚ö†Ô∏è Condition Detected
                        {% endif %}
                    </div>

                    <h2 class="prediction-name">{{ disease.name }}</h2>

                    <div class="confidence-section">
                        <div class="confidence-label">
                            <span>Confidence</span>
                            <span class="confidence-value">{{ "%.1f"|format(prediction.confidence * 100) }}%</span>
                        </div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="--target-width: {{ prediction.confidence * 100 }}%">
                            </div>
                        </div>
                    </div>

                    <p class="prediction-overview">{{ disease.overview[:200] }}...</p>

                    <div class="prediction-meta">
                        <div class="meta-item">
                            <span class="meta-label">Severity</span>
                            <span class="meta-value">{{ disease.severity }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Recovery</span>
                            <span class="meta-value">{{ disease.recovery_time[:30] }}...</span>
                        </div>
                    </div>

                    <a href="{{ url_for('disease_detail', slug=disease.slug) }}" class="btn-learn-more">
                        <span>Learn More & Treatment</span>
                        <span class="btn-arrow">‚Üí</span>
                    </a>
                </div>
            </div>

            <!-- All Predictions -->
            <div class="all-predictions glass-card">
                <h3>All Predictions</h3>
                <div class="predictions-list">
                    {% for class_name, prob in all_predictions.items() | sort(attribute='1', reverse=true) %}
                    <div class="prediction-item {% if class_name == prediction.class %}active{% endif %}">
                        <div class="pred-info">
                            <span class="pred-name">
                                {{ diseases_display.get(class_name, class_name.replace('_', ' ').title()) if
                                diseases_display is defined else class_name.replace('_', ' ').title() }}
                            </span>
                            <span class="pred-percent">{{ "%.1f"|format(prob * 100) }}%</span>
                        </div>
                        <div class="pred-bar">
                            <div class="pred-bar-fill" style="--target-width: {{ prob * 100 }}%"></div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="result-actions">
                <a href="/" class="btn-secondary">
                    <span>üì∏</span> Upload Another Image
                </a>
                <a href="{{ url_for('disease_detail', slug=disease.slug) }}" class="btn-primary">
                    <span>üìñ</span> View Full Details & Treatment
                </a>
            </div>
        </div>
    </section>

    <!-- Chat Widget -->
    {% include 'chat_widget.html' %}

    <!-- Footer -->
    <footer class="footer">
        <div class="section-container">
            <div class="footer-content">
                <p class="footer-note">‚ö†Ô∏è This tool is for educational purposes only. Always consult a licensed
                    veterinarian.</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>